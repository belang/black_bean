# 说明
这里设计的指令是硬件执行的指令。它是传统意义的指令集编译之后的指令。

# 指令设计

以硬件每个执行动作为基本单位进行设计。
指令流水级为取指、译码、发射、执行、写回。
不管一拍还是多拍完成，整个流水级要完整，则数据通道要足够。
很多功能需要多个操作数，功能结果也可能是多个操作数，
要一拍完成，则数据通道要多条。
同时，寄存器只能一次读一条数据，或写一条数据，
要一拍完成，则读写要分离，读写数据通道都不只一条。
例如一条加法指令可以拆分成：取数1、取数2、计算、写结果，四个步骤。
要实现一拍或流水，需要两个读数通道，一个写通道。

还有一种选择是拆分指令。四个步骤分成四个指令，顺序执行。
单动作指令设计灵活，更能体现硬件信号传输过程，所以以单动作指令进行设计。

硬件基本操作是读和写。操作内容是地址（端口）和数据。操作对象有内存、寄存器、运算器、外设。
由此设计单动作指令格式为：读、写，对象，地址（立即数）。
无论读写，默认数据在对应的数据总线中。
每一对读写动作完成一次数据搬运。因为读写之间的数据缓存在数据总线上，
所以读写操作必须成对出现，而且连续读写。如果不连续，则需要缓存。

## 单动作指令
每个单动作指令由两行指令，共8*2=16个字节构成。
其结构如下：

前8位是器件名称，后8位是端口（地址）

### 器件划分

| 名称       | 编码 | 简称 |                |
|------------|------|------|----------------|
| 指令寄存器 | 0001 | 令寄 |                |
| 数据寄存器 | 0010 | 数寄 |                |
| 运算器     | 0011 | 运算 |                |
| 外设       | 0100 | 外   |                |
| 控制       | 0101 | 控   |                |
| 缓存       | 0111 | 缓   | 用来设置立即数 |

#### 外设

| 名称         | 编码 | 说明                               | 简称     |
|--------------|------|------------------------------------|----------|
| 内存指令     | 0001 | 向内存控制器发送指令，控制内存读写 |          |
| 内存数据读   | 0010 | 读取内存控制器缓存的数据，一次一行 |          |
| 内存数据写   | 0011 | 向内存控制器缓存写入数据，一次一行 |          |
| 内存数据有效 |      |                                    | 内存数备 |
|              |      |                                    |          |

#### 运算

| 名称     | 编码 | 说明 | 简称 |
|----------|------|------|------|
| 被加数   | 0001 | 写   | 基   |
| 加数     | 0010 | 写   | 累   |
| 加结果   | 0011 | 读   | 和   |
| 加进位   | 0100 | 读   | 进   |
| 被比较数 | 0110 | 写   | 尺   |
| 比较数   | 0101 | 写   | 量   |
| 比较结果 | 0111 | 读   | 较   |

#### 控制

| 名称     | 编码 | 说明                       | 简称 |
|----------|------|----------------------------|------|
| 工作     | 0010 | 空，切换到工作寄存器       |      |
| 大于跳   | 0011 | 写，输入的是比较结果       |      |
| 小于跳   | 0100 | 写                         |      |
| 等于跳   | 0101 | 写                         |      |
| 不等于跳 | 0101 | 写                         | 异跳 |
| 直接跳   | 0110 | 写                         | 同跳 |
| 跳转地址 | 0110 | 写                         | 跳达 |
| 等待     | 0111 | 写，等待某个值为高（有效） |      |
| 停       | 1000 | 空，代表停止               |      |

## 组合动作
加载数据动作由跳转、计数、读、写、等待构成。

| 动作 | 运算   | 读       | 缓存   | 写     |                  |
| 指令 | 源器件 | 源地址   | 终器件 | 终地址 |                  |
|------|--------|----------|--------|--------|------------------|
| 加   | *      | *        | 运算   | 基     |                  |
| T16  | *      | *        | 运算   | 累     |                  |
|      | 运算   | 加结果   | *      | *      |                  |
|      | 运算   | 加进位   | *      | *      |                  |
| 比较 | *      | *        | 运算   | 尺     |                  |
|      | *      | *        | 运算   | 量     |                  |
|      | 运算   | 较       | *      | *      |                  |
| 跳转 | *      | *        | 控制   | *跳    | 判断条件         |
|      | *      | *        | 控制   | 跳达   | 跳转地址         |
| 加载 | 缓存   | 00000001 | 运算   | 尺     |                  |
|      | 缓存   | 8'h9     | 数寄   | 0      |                  |
|      | 外设   | 内存数备 | 运算   | 量     |                  |
|      | 运算   | 较       | 控制   | 异跳   |                  |
|      | 数寄   | 0        | 控制   | 跳达   | ？先写入跳转地址 |
|      | 运算   | 较       | *      | *      |                  |


